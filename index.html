<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>לוח בקרה אישי</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #f4f7f6; }
        .task-card { border: 2px solid #ddd; margin: 10px; padding: 15px; border-radius: 8px; }
        .urgent { border-color: red; background-color: #ffe6e6; }
        .water-cup { display: inline-block; width: 50px; height: 70px; border: 2px solid blue; margin: 5px; }
        .filled { background-color: #3498db; }
    </style>
</head>
<body>
    <h1>שלום, אלו המשימות שלך להיום</h1>
    
    <div id="water-section">
        <h3>שתיית מים (יעד: <span id="target"></span> כוסות)</h3>
        <div id="cups-container"></div>
        <button onclick="reportAction('water', 1)">שתיתי כוס מים</button>
    </div>

    <div id="tasks-container"></div>

    <script>
        const CONFIG_URL = 'https://raw.githubusercontent.com/USER/REPO/main/config.json';
        const MAKE_WEBHOOK = 'https://hook.make.com/YOUR_REPORT_ID';

        async function fetchData() {
            const response = await fetch(`${CONFIG_URL}?t=${new Date().getTime()}`);
            const data = await response.json();
            renderUI(data);
        }

        function renderUI(data) {
            // עיבוד כוסות מים
            const container = document.getElementById('cups-container');
            container.innerHTML = '';
            for(let i=0; i<data.dailyLimit; i++) {
                const cup = document.createElement('div');
                cup.className = `water-cup ${i < data.consumed ? 'filled' : ''}`;
                container.appendChild(cup);
            }
            document.getElementById('target').innerText = data.dailyLimit;

            // עיבוד משימות
            const taskContainer = document.getElementById('tasks-container');
            taskContainer.innerHTML = '';
            data.tasks.forEach(task => {
                const div = document.createElement('div');
                div.className = 'task-card';
                div.innerHTML = `<b>${task.name}</b> - בשעה ${task.time} 
                                 <button onclick="reportAction('task', '${task.name}')">בוצע</button>`;
                taskContainer.appendChild(div);
            });
        }

        async function reportAction(type, value) {
            await fetch(MAKE_WEBHOOK, {
                method: 'POST',
                body: JSON.stringify({ type, value, timestamp: new Date().toISOString() })
            });
            alert("הדיווח נשלח בהצלחה");
        }

        setInterval(fetchData, 60000);
        fetchData();
    </script>
</body>
</html>
